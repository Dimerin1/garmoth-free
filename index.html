<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BDO Grind Tracker</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <header>
            <h1>‚öîÔ∏è BDO Grind Tracker</h1>
            <p class="subtitle">Calculate earnings with live market prices</p>
        </header>

        <div class="status-bar">
            <div class="status-item">
                <span class="status-label">Market Prices</span>
                <span class="status-value" id="priceStatus">Loading...</span>
            </div>
            <div class="status-item">
                <span class="status-label">Items Loaded</span>
                <span class="status-value" id="itemCount">0</span>
            </div>
            <button class="refresh-btn" onclick="refreshPrices()">üîÑ Refresh Prices</button>
        </div>

        <!-- All Spots Comparison -->
        <section class="comparison-section">
            <div class="comparison-header">
                <h2>üìä All Spots Comparison</h2>
                <div class="comparison-controls">
                    <button class="toggle-btn" onclick="toggleComparison()">
                        <span id="toggleIcon">‚ñº</span> <span id="toggleText">Hide</span>
                    </button>
                </div>
            </div>
            <div class="comparison-table-container" id="comparisonContainer">
                <table class="comparison-table" id="comparisonTable">
                    <thead>
                        <tr>
                            <th class="sortable" onclick="sortComparison('name')">Spot <span class="sort-icon"></span>
                            </th>
                            <th class="sortable" onclick="sortComparison('total100')">100% Silver/hr <span
                                    class="sort-icon"></span></th>
                            <th class="sortable active" onclick="sortComparison('total320')">320% Silver/hr <span
                                    class="sort-icon">‚ñº</span></th>
                            <th class="sortable" onclick="sortComparison('total370')">370% Silver/hr <span
                                    class="sort-icon"></span></th>
                            <th>Trash/hr</th>
                        </tr>
                    </thead>
                    <tbody id="comparisonBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>


        <div class="main-grid">
            <!-- Left Panel: Spot Configuration -->
            <section class="config-panel">
                <h2>üìç Grind Spot Setup</h2>

                <div class="input-group">
                    <label>Select Spot</label>
                    <select id="spotSelect" class="spot-select">
                        <!-- Populated by JavaScript -->
                    </select>
                </div>

                <div class="input-group">
                    <label>Spot Name</label>
                    <input type="text" id="spotName" value="Darkseeker's Retreat" placeholder="Enter spot name">
                </div>

                <div class="trash-section">
                    <h3>üóëÔ∏è Trash Loot</h3>
                    <div class="input-group">
                        <label>Trash Item Name</label>
                        <input type="text" id="trashName" value="Decayed Cloth" placeholder="Trash item name" readonly>
                    </div>
                    <div class="input-group">
                        <label>NPC Price (Silver)</label>
                        <input type="number" id="trashPrice" value="46000" placeholder="46000" readonly>
                    </div>

                    <div class="trash-comparison">
                        <div class="trash-stat baseline">
                            <span class="stat-label">üìä Garmoth Baseline</span>
                            <span class="stat-value" id="baselineTrash">35,361</span>
                            <span class="stat-unit">/hr</span>
                        </div>
                        <div class="trash-stat custom">
                            <span class="stat-label">‚öîÔ∏è Your Rate</span>
                            <input type="number" id="trashPerHour" class="stat-input" value="41000"
                                placeholder="Your trash/hr" oninput="onTrashRateChange()">
                            <span class="stat-unit">/hr</span>
                        </div>
                        <div class="trash-stat diff" id="trashDiffContainer">
                            <span class="stat-label">üìà Difference</span>
                            <span class="stat-value" id="trashDiff">+5,639</span>
                            <span class="stat-unit">(+15.9%)</span>
                        </div>
                    </div>
                </div>

                <div class="items-section">
                    <h3>üíé Drop Items</h3>
                    <div class="add-item-row">
                        <input type="text" id="newItemName" placeholder="Item name (from market)"
                            list="itemSuggestions">
                        <datalist id="itemSuggestions"></datalist>
                        <input type="number" id="newItemRate" placeholder="Drops/hr" step="0.001">
                        <button class="add-btn" onclick="addItem()">+ Add</button>
                    </div>

                    <div class="items-table-container">
                        <table class="items-table" id="itemsTable">
                            <thead>
                                <tr>
                                    <th>Item</th>
                                    <th>Market Price</th>
                                    <th>Drops/hr</th>
                                    <th>Silver/hr (100%)</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="itemsBody">
                                <!-- Items added dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Right Panel: Results -->
            <section class="results-panel">
                <h2>üí∞ Earnings Breakdown</h2>

                <div class="results-cards">
                    <div class="result-card base">
                        <div class="card-header">
                            <span class="rate-badge">100%</span>
                            <span class="rate-label">Base Drop Rate</span>
                        </div>
                        <div class="card-body">
                            <div class="trash-earnings">
                                <span class="label">Trash Loot</span>
                                <span class="value" id="trash100">0</span>
                            </div>
                            <div class="drop-earnings">
                                <span class="label">Drop Items</span>
                                <span class="value" id="drops100">0</span>
                            </div>
                            <div class="total-earnings">
                                <span class="label">Total Silver/hr</span>
                                <span class="value" id="total100">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="result-card scroll">
                        <div class="card-header">
                            <span class="rate-badge">320%</span>
                            <span class="rate-label">Loot Scroll + Agris</span>
                        </div>
                        <div class="card-body">
                            <div class="trash-earnings">
                                <span class="label">Trash Loot</span>
                                <span class="value" id="trash320">0</span>
                            </div>
                            <div class="drop-earnings">
                                <span class="label">Drop Items</span>
                                <span class="value" id="drops320">0</span>
                            </div>
                            <div class="total-earnings">
                                <span class="label">Total Silver/hr</span>
                                <span class="value" id="total320">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="result-card arsha">
                        <div class="card-header">
                            <span class="rate-badge">370%</span>
                            <span class="rate-label">Arsha Server</span>
                        </div>
                        <div class="card-body">
                            <div class="trash-earnings">
                                <span class="label">Trash Loot</span>
                                <span class="value" id="trash370">0</span>
                            </div>
                            <div class="drop-earnings">
                                <span class="label">Drop Items</span>
                                <span class="value" id="drops370">0</span>
                            </div>
                            <div class="total-earnings">
                                <span class="label">Total Silver/hr</span>
                                <span class="value" id="total370">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="comparison-chart">
                    <h3>üìä Comparison</h3>
                    <div class="chart-bars">
                        <div class="bar-group">
                            <div class="bar bar-100" id="bar100"></div>
                            <span>100%</span>
                        </div>
                        <div class="bar-group">
                            <div class="bar bar-320" id="bar320"></div>
                            <span>320%</span>
                        </div>
                        <div class="bar-group">
                            <div class="bar bar-370" id="bar370"></div>
                            <span>370%</span>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <footer>
            <p>Prices from <a href="https://docs.google.com/spreadsheets/d/1HJpWrM05pDmreys8pmg0VuV0e5ZDJ0ePp_mXI-hGsJc"
                    target="_blank">BDO Market API</a> ‚Ä¢ Built for grinders üéÆ</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>

</html>